# üß™ VERIFICATION PLAN - Trader Gemini Bot

**Purpose:** Systematic verification of all bot components before live trading  
**Estimated Time:** 2-3 hours  
**Prerequisites:** Bot installed, `.env` configured

---

## VERIFICATION MATRIX

| Test ID | Component | Type | Status |
|---------|-----------|------|--------|
| V001 | Environment Configuration | Automated | ‚è≥ Pending |
| V002 | API Authentication | Automated | ‚è≥ Pending |
| V003 | Exception Handling | Automated | ‚è≥ Pending |
| V004 | Order Execution | Manual | ‚è≥ Pending |
| V005 | Stop-Loss Triggers | Manual | ‚è≥ Pending |
| V006 | Position Sizing | Manual | ‚è≥ Pending |
| V007 | Network Recovery | Manual | ‚è≥ Pending |
| V008 | Cash Reservation | Manual | ‚è≥ Pending |
| V009 | Dashboard Data Flow | Manual | ‚è≥ Pending |
| V010 | 24-Hour Stress Test | Manual | ‚è≥ Pending |

---

## AUTOMATED TESTS

### V001: Environment Configuration
**Command:**
```bash
python tests/test_validation.py
```

**Pass Criteria:**
- ‚úÖ No hardcoded API keys detected
- ‚úÖ .env file exists with required keys
- ‚úÖ .gitignore protects .env
- ‚úÖ Config validation function exists

**Expected Output:**
```
‚úÖ PASSED: Hardcoded Secrets
‚úÖ PASSED: Environment Files
‚úÖ PASSED: Config Validation
‚úÖ PASSED: Exception Handling
Overall: 4/4 tests passed (100%)
```

**Result:** [ ] PASS / [ ] FAIL  
**Notes:**

---

### V002: API Authentication
**Command:**
```bash
python -c "from execution.binance_executor import BinanceExecutor; from queue import Queue; ex = BinanceExecutor(Queue(), None); print('‚úÖ Authentication successful')"
```

**Pass Criteria:**
- ‚úÖ "Exchange credentials verified" message appears
- ‚úÖ No authentication errors
- ‚úÖ Connection to Demo/Testnet successful

**Expected Output:**
```
Binance Executor: Configured for Demo Trading (Futures)
  ‚úÖ Exchange credentials verified
  ‚úÖ Position Mode set to ONE-WAY
  ‚úÖ Margin Types Configured
‚úÖ Authentication successful
```

**Result:** [ ] PASS / [ ] FAIL  
**Notes:**

---

### V003: Exception Handling Quality
**Command:**
```bash
python tests/test_validation.py
```

**Pass Criteria:**
- ‚úÖ Specific exceptions > Generic exceptions
- ‚úÖ At least 10 specific exception types used
- ‚úÖ Critical files (main.py, binance_executor.py) refactored

**Expected Output:**
```
binance_executor.py:
  Generic exceptions: 3
  Specific exceptions: 25

main.py:
  Generic exceptions: 0
  Specific exceptions: 15

‚úÖ PASSED: Specific exception handling dominates
```

**Result:** [ ] PASS / [ ] FAIL  
**Notes:**

---

## MANUAL TESTS

### V004: Order Execution Flow
**Objective:** Verify full order lifecycle from signal to fill

**Steps:**
1. Start bot: `python main.py --mode futures`
2. Wait for market data to load (1-2 min)
3. Wait for strategy to generate signal
4. Observe order execution

**Expected Behavior:**
```
üìä LONG Signal: BTC/USDT (Strategy: TECHNICAL, Strength: 0.85)
‚úÖ Risk Manager: Approved BUY 0.0050 BTC/USDT ($150.00)
‚ùÑÔ∏è  Risk Manager: Cooldown activated for BTC/USDT (1m)
üìä BinanceExecutor: Executing BUY Market Order for BTC/USDT
‚úÖ ORDER FILLED: BTC/USDT | BUY | 0.0050 @ $30,000.00
```

**Pass Criteria:**
- [ ] Signal generated by strategy
- [ ] Risk manager approves order
- [ ] Cash reserved before API call
- [ ] Order sent to Binance
- [ ] FillEvent created
- [ ] Portfolio updated with position
- [ ] Protective stops placed (Layer 3)

**Result:** [ ] PASS / [ ] FAIL  
**Notes:**

---

### V005: Stop-Loss Trigger Verification
**Objective:** Verify stop-loss executes correctly

**Steps:**
1. Wait for bot to open a position
2. Monitor price movement
3. If price drops 2%, verify stop-loss triggers

**Expected Behavior:**
```
üõë Stop Loss Hit for BTC/USDT! Price: 29,400.00, Entry: 30,000.00, Stop: 29,400.00 (Loss: -2.00%)
üìä EXIT Signal: BTC/USDT (Strategy: RISK_MGR)
‚úÖ Risk Manager: Approved SELL 0.0050 BTC/USDT ($147.00)
‚úÖ ORDER FILLED: BTC/USDT | SELL | 0.0050 @ $29,400.00
üí∞ Position closed: BTC/USDT | P&L: -$3.00 (-2.00%)
```

**Pass Criteria:**
- [ ] Stop-loss triggers at correct price (-2%)
- [ ] EXIT signal generated
- [ ] Position closed automatically
- [ ] Cash released back to portfolio
- [ ] Cooldown activated (prevents re-entry)

**Result:** [ ] PASS / [ ] FAIL  
**Actual Stop Price:** $__________  
**Expected Stop Price:** $__________  
**Notes:**

---

### V006: Position Sizing Validation
**Objective:** Verify position size follows risk parameters

**Steps:**
1. Note portfolio equity: `E = $__________`
2. Wait for LONG signal
3. Record approved order size: `S = $__________`
4. Calculate position size %: `P = (S / E) * 100`

**Expected Calculation:**
```python
# For medium account ($1,000 - $10,000)
Expected % = 15% ¬± 5% (accounting for signal strength)

# Example:
Portfolio Equity = $10,000
Expected Size = $1,500 (15%)
Actual Size = $________ (_____%)
```

**Pass Criteria:**
- [ ] Position size within expected range (10-20% for medium account)
- [ ] Smaller size if signal strength < 1.0
- [ ] Larger size if using ATR-based volatility sizing
- [ ] Minimum order size >= $5

**Result:** [ ] PASS / [ ] FAIL  
**Portfolio Equity:** $__________  
**Order Size:** $__________  
**Position %:** __________%  
**Notes:**

---

### V007: Network Recovery Test
**Objective:** Verify bot recovers from network interruption

**Steps:**
1. Start bot: `python main.py --mode futures`
2. Wait for bot to be running normally (data updating)
3. Disconnect internet for 30 seconds
4. Observe bot behavior
5. Reconnect internet
6. Verify bot auto-recovers

**Expected Behavior (During Disconnect):**
```
‚ö†Ô∏è Network error fetching data for BTC/USDT: Connection refused
‚ö†Ô∏è Network error fetching data for ETH/USDT: Connection refused
‚ùå BinanceLoader Background Error: Network unreachable
```

**Expected Behavior (After Reconnect):**
```
New Bar for BTC/USDT: 2025-12-04 00:15:00 - Close: 30125.50
New Bar for ETH/USDT: 2025-12-04 00:15:00 - Close: 2150.25
‚úÖ Data fetching resumed
```

**Pass Criteria:**
- [ ] Bot logs network errors but doesn't crash
- [ ] Bot continues retry loop
- [ ] Bot auto-recovers when connection restored
- [ ] No positions lost or corrupted
- [ ] No duplicate orders placed

**Result:** [ ] PASS / [ ] FAIL  
**Recovery Time:** __________ seconds  
**Notes:**

---

### V008: Cash Reservation & Release
**Objective:** Verify cash management prevents double-spending

**Steps:**
1. Note initial cash: `C1 = $__________`
2. Wait for order to be approved
3. Note reserved cash before order sent
4. Verify order executes successfully
5. Note final cash: `C2 = $__________`

**Expected Behavior:**
```
Portfolio Cash BEFORE: $10,000.00
‚úÖ Risk Manager: Approved BUY 0.0050 BTC/USDT ($150.00)
üíµ Reserved $150.00 cash for order
Portfolio Available Cash: $9,850.00 (reserved: $150.00)
‚úÖ ORDER FILLED: BTC/USDT | BUY | 0.0050 @ $30,000.00
üíµ Released reserved cash, updated with actual cost
Portfolio Cash AFTER: $9,850.00
```

**Pass Criteria:**
- [ ] Cash reserved BEFORE API call
- [ ] Available cash reduces by reserved amount
- [ ] If order fails, cash is released
- [ ] If order succeeds, cash updated withactual cost + fees
- [ ] No negative cash balance

**Failure Test:**
1. Edit config to set impossibly large position size
2. Verify order is rejected and cash is NOT reserved

**Result:** [ ] PASS / [ ] FAIL  
**Initial Cash:** $__________  
**Reserved:** $__________  
**Final Cash:** $__________  
**Notes:**

---

### V009: Dashboard Data Flow
**Objective:** Verify dashboard receives real-time updates

**Steps:**
1. Start bot: `python main.py --mode futures`
2. Start dashboard: `cd dashboard && python app.py`
3. Open browser: http://localhost:5000
4. Wait for a trade to execute
5. Verify dashboard updates

**Expected Dashboard Elements:**
- [ ] **Portfolio Panel:** Shows current equity, cash, PnL
- [ ] **Open Positions:** Displays active positions with entry price
- [ ] **Recent Trades:** Shows last 10 trades with P&L
- [ ] **Strategy Performance:** Charts showing equity curve
- [ ] **Market Data:** Live prices for all symbols

**Pass Criteria:**
- [ ] Dashboard loads without errors
- [ ] Data updates in real-time (< 5 second delay)
- [ ] PnL calculations match portfolio logs
- [ ] Positions display correctly (long/short)
- [ ] CSV files sync correctly

**Result:** [ ] PASS / [ ] FAIL  
**Notes:**

---

### V010: 24-Hour Stress Test
**Objective:** Verify bot runs stably for extended period

**Steps:**
1. Start bot: `python main.py --mode futures`
2. Let run for 24 hours unattended
3. Monitor logs periodically
4. Verify no crashes or memory leaks

**Monitoring Checklist (Every 6 Hours):**
- [ ] Bot still running (not crashed)
- [ ] Memory usage < 1GB
- [ ] No repeated errors in logs
- [ ] Positions opening and closing normally
- [ ] Dashboard data still updating

**Expected Metrics (After 24h):**
- Total trades: 5-20 (depending on market volatility)
- Memory usage: < 800MB
- API calls: < 100,000 (rate limit safe)
- Uptime: 100%

**Pass Criteria:**
- [ ] Bot runs for full 24 hours without crash
- [ ] No memory leaks (usage stays stable)
- [ ] All trades execute correctly
- [ ] No API rate limit errors
- [ ] Graceful shutdown works after 24h

**Result:** [ ] PASS / [ ] FAIL  
**Actual Uptime:** __________ hours  
**Total Trades:** __________  
**Final Memory Usage:** __________ MB  
**Notes:**

---

## VERIFICATION SUMMARY

### Test Results
| Test ID | Component | Result | Notes |
|---------|-----------|--------|-------|
| V001 | Environment Config | [ ] P / [ ] F | |
| V002 | API Auth | [ ] P / [ ] F | |
| V003 | Exception Handling | [ ] P / [ ] F | |
| V004 | Order Execution | [ ] P / [ ] F | |
| V005 | Stop-Loss | [ ] P / [ ] F | |
| V006 | Position Sizing | [ ] P / [ ] F | |
| V007 | Network Recovery | [ ] P / [ ] F | |
| V008 | Cash Reservation | [ ] P / [ ] F | |
| V009 | Dashboard | [ ] P / [ ] F | |
| V010 | 24h Stress Test | [ ] P / [ ] F | |

### Overall Status
- **Tests Passed:** _____ / 10
- **Tests Failed:** _____ / 10
- **Pass Rate:** _____  %

### Approval Decision
- [ ] ‚úÖ **APPROVED FOR DEMO TRADING** (8+ tests passed)
- [ ] ‚ö†Ô∏è **CONDITIONAL APPROVAL** (6-7 tests passed, fix issues)
- [ ] ‚ùå **NOT APPROVED** (< 6 tests passed, major issues)

### Sign-Off
**Tester Name:** __________________  
**Date:** __________________  
**Signature:** __________________

---

## NEXT STEPS

### If Approved
1. Run bot in Demo mode for 1 week
2. Monitor daily PnL and behavior
3. Document any edge cases
4. Consider live trading with < 1% capital

### If Issues Found
1. Document all failures in detail
2. Review error logs
3. Apply fixes from SECURITY_CHECKLIST.md
4. Re-run failed tests

---

**VERIFICATION STATUS:** ‚è≥ IN PROGRESS  
**START DATE:** __________________  
**COMPLETION DATE:** __________________
